---
import { useTranslations } from '../i18n/utils';
import type { Lang } from '../i18n/ui';

interface Props {
  lang: Lang;
}

const { lang } = Astro.props;
const t = useTranslations(lang);

const licensePerks = [
  { title: 'os.license.audit', desc: 'os.license.audit.desc' },
  { title: 'os.license.fork', desc: 'os.license.fork.desc' },
  { title: 'os.license.contribute', desc: 'os.license.contribute.desc' },
  { title: 'os.license.commercial', desc: 'os.license.commercial.desc' },
] as const;

const closedItems = ['os.why.closed.1', 'os.why.closed.2', 'os.why.closed.3', 'os.why.closed.4'] as const;
const openItems = ['os.why.open.1', 'os.why.open.2', 'os.why.open.3', 'os.why.open.4'] as const;

const values = ['os.builders.v1', 'os.builders.v2', 'os.builders.v3', 'os.builders.v4'] as const;
---

<section id="open-source" class="py-20 md:py-28 px-4 md:px-8 bg-surface-section">
  <div class="max-w-6xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-14 md:mb-20">
      <h2 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-th mb-4">
        {t('os.header')}
      </h2>
      <p class="text-xl md:text-2xl font-semibold text-green-400 mb-4">
        {t('os.tagline')}
      </p>
      <p class="text-base md:text-lg text-tsec max-w-3xl mx-auto leading-relaxed">
        {t('os.intro')}
      </p>
    </div>

    <!-- License + Verify Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16">
      <!-- Fully Open Source -->
      <div class="p-6 md:p-8 bg-surface-card border border-b-subtle rounded-2xl">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 flex items-center justify-center rounded-xl bg-green-400/10 text-green-400">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 9.9-1"/>
            </svg>
          </div>
          <h3 class="text-xl md:text-2xl font-bold text-th">{t('os.license.title')}</h3>
        </div>
        <div class="inline-block px-3 py-1 mb-6 bg-green-400/10 border border-green-400/20 rounded-full text-sm text-green-400 font-medium">
          {t('os.license.name')}
        </div>
        <div class="flex flex-col gap-4">
          {licensePerks.map(({ title, desc }) => (
            <div class="flex gap-3 items-start">
              <svg class="w-5 h-5 text-green-400 mt-0.5 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              <div>
                <span class="font-medium text-ts">{t(title as any)}</span>
                <span class="text-tm"> â€” {t(desc as any)}</span>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Verify Everything -->
      <div class="p-6 md:p-8 bg-surface-card border border-b-subtle rounded-2xl">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 flex items-center justify-center rounded-xl bg-green-400/10 text-green-400">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <line x1="21" y1="21" x2="16.65" y2="16.65"/>
            </svg>
          </div>
          <h3 class="text-xl md:text-2xl font-bold text-th">{t('os.verify.title')}</h3>
        </div>
        <div class="flex flex-col gap-6">
          <!-- Source Code -->
          <div>
            <h4 class="text-sm font-semibold text-tb mb-1">{t('os.verify.source')}</h4>
            <p class="text-sm text-tm mb-2">{t('os.verify.source.desc')}</p>
            <a href="https://github.com/olympus-btc/ambrosia" target="_blank" rel="noopener noreferrer" class="group inline-flex items-center gap-1.5 text-sm font-medium text-green-400 hover:text-green-300 transition-colors">
              {t('os.verify.source.cta')}
              <svg class="w-4 h-4 group-hover:translate-x-0.5 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/>
              </svg>
            </a>
          </div>
          <!-- Releases -->
          <div>
            <h4 class="text-sm font-semibold text-tb mb-1">{t('os.verify.releases')}</h4>
            <p class="text-sm text-tm mb-2">{t('os.verify.releases.desc')}</p>
            <a href="https://github.com/olympus-btc/ambrosia/releases" target="_blank" rel="noopener noreferrer" class="group inline-flex items-center gap-1.5 text-sm font-medium text-green-400 hover:text-green-300 transition-colors">
              {t('os.verify.releases.cta')}
              <svg class="w-4 h-4 group-hover:translate-x-0.5 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/>
              </svg>
            </a>
          </div>
          <!-- Dependencies -->
          <div>
            <h4 class="text-sm font-semibold text-tb mb-1">{t('os.verify.deps')}</h4>
            <p class="text-sm text-tm">{t('os.verify.deps.desc')}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Community + Security Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16">
      <!-- Community -->
      <div class="p-6 md:p-8 bg-surface-card border border-b-subtle rounded-2xl">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 flex items-center justify-center rounded-xl bg-green-400/10 text-green-400">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
              <circle cx="9" cy="7" r="4"/>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
          </div>
          <h3 class="text-xl md:text-2xl font-bold text-th">{t('os.community.title')}</h3>
        </div>
        <div class="flex flex-col gap-3 mb-6">
          <div class="flex items-center gap-2 text-sm text-tb">
            <span class="text-green-400">&#x2022;</span> {t('os.community.bugs')}
          </div>
          <div class="flex items-center gap-2 text-sm text-tb">
            <span class="text-green-400">&#x2022;</span> {t('os.community.pr')}
          </div>
          <div class="flex items-center gap-2 text-sm text-tb">
            <span class="text-green-400">&#x2022;</span> {t('os.community.docs')}
          </div>
          <div class="flex items-center gap-2 text-sm text-tb">
            <span class="text-green-400">&#x2022;</span> {t('os.community.translate')}
          </div>
        </div>
        <div class="flex flex-wrap gap-3">
          <a href="https://github.com/olympus-btc/ambrosia/milestones" target="_blank" rel="noopener noreferrer" class="group inline-flex items-center gap-1.5 text-sm font-medium text-green-400 hover:text-green-300 transition-colors">
            {t('os.community.milestones')}
            <svg class="w-4 h-4 group-hover:translate-x-0.5 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/>
            </svg>
          </a>
          <span class="text-tf">|</span>
          <a href="https://github.com/olympus-btc/ambrosia/issues" target="_blank" rel="noopener noreferrer" class="group inline-flex items-center gap-1.5 text-sm font-medium text-green-400 hover:text-green-300 transition-colors">
            {t('os.community.issues')}
            <svg class="w-4 h-4 group-hover:translate-x-0.5 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/>
            </svg>
          </a>
        </div>
      </div>

      <!-- Security -->
      <div class="p-6 md:p-8 bg-surface-card border border-b-subtle rounded-2xl">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 flex items-center justify-center rounded-xl bg-green-400/10 text-green-400">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
          </div>
          <h3 class="text-xl md:text-2xl font-bold text-th">{t('os.security.title')}</h3>
        </div>
        <div class="flex flex-col gap-6">
          <div>
            <h4 class="text-sm font-semibold text-tb mb-1">{t('os.security.disclosure')}</h4>
            <p class="text-sm text-tm mb-2">{t('os.security.disclosure.desc')}</p>
            <a href="mailto:contact@ambrosiapay.com" class="inline-flex items-center gap-2 text-sm font-medium text-green-400 hover:text-green-300 transition-colors">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                <polyline points="22,6 12,13 2,6"/>
              </svg>
              {t('os.security.email')}
            </a>
          </div>
          <div>
            <h4 class="text-sm font-semibold text-tb mb-1">{t('os.security.telemetry')}</h4>
            <p class="text-sm text-tm">{t('os.security.telemetry.desc')}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Built by Bitcoiners -->
    <div class="p-6 md:p-8 bg-surface-card border border-b-subtle rounded-2xl mb-16">
      <div class="flex flex-col md:flex-row md:items-start gap-8">
        <div class="md:w-1/2">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 flex items-center justify-center rounded-xl bg-green-400/10 text-green-400">
              <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
              </svg>
            </div>
            <h3 class="text-xl md:text-2xl font-bold text-th">{t('os.builders.title')}</h3>
          </div>
          <p class="text-sm md:text-base text-tsec leading-relaxed">
            {t('os.builders.desc')}
          </p>
        </div>
        <div class="md:w-1/2 flex flex-col gap-3">
          {values.map((v) => (
            <div class="flex items-center gap-3 p-3 bg-surface-card rounded-lg border border-b-subtle">
              <div class="w-2 h-2 rounded-full bg-green-400 shrink-0"></div>
              <span class="text-sm text-tb">{t(v as any)}</span>
            </div>
          ))}
        </div>
      </div>
    </div>

    <!-- Why Open Source Matters -->
    <div class="mb-16">
      <h3 class="text-2xl md:text-3xl font-bold text-th text-center mb-10">
        {t('os.why.title')}
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
        <!-- Closed source -->
        <div class="p-6 md:p-8 bg-red-400/5 border border-red-400/10 rounded-2xl">
          <p class="text-sm font-semibold text-red-400 mb-4">{t('os.why.closed')}</p>
          <div class="flex flex-col gap-3">
            {closedItems.map((item) => (
              <div class="flex gap-3 items-start">
                <svg class="w-5 h-5 text-red-400 mt-0.5 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
                <span class="text-sm text-tsec">{t(item as any)}</span>
              </div>
            ))}
          </div>
        </div>
        <!-- Open source -->
        <div class="p-6 md:p-8 bg-green-400/5 border border-green-400/10 rounded-2xl">
          <p class="text-sm font-semibold text-green-400 mb-4">{t('os.why.open')}</p>
          <div class="flex flex-col gap-3">
            {openItems.map((item) => (
              <div class="flex gap-3 items-start">
                <svg class="w-5 h-5 text-green-400 mt-0.5 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
                <span class="text-sm text-tb">{t(item as any)}</span>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>

    <!-- Quote -->
    <blockquote class="text-center mb-16 max-w-3xl mx-auto">
      <p class="text-lg md:text-xl text-tb italic leading-relaxed">
        "{t('os.why.quote')}"
      </p>
    </blockquote>

    <!-- CTAs -->
    <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
      <a href="https://github.com/olympus-btc/ambrosia" target="_blank" rel="noopener noreferrer" class="group inline-flex items-center justify-center gap-2 px-6 py-3.5 bg-transparent text-th font-medium border border-b-strong rounded-lg w-full sm:w-auto hover:bg-surface-interactive hover:border-b-strongest transition-all">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
        </svg>
        {t('os.cta.github')}
        <svg class="w-4 h-4 group-hover:translate-x-0.5 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/>
        </svg>
      </a>
      <a href="#download" class="inline-flex items-center justify-center gap-2 px-6 py-3.5 bg-linear-to-br from-green-400 to-green-600 text-t-on-accent font-semibold rounded-lg w-full sm:w-auto hover:-translate-y-0.5 transition-all shadow-[0_4px_14px_rgba(74,222,128,0.3)] hover:shadow-[0_6px_20px_rgba(74,222,128,0.4)]">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        {t('os.cta.download')}
      </a>
    </div>
  </div>
</section>
